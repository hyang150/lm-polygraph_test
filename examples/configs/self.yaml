# ========== Hydra 全局配置 ==========
hydra:
  run:
    dir: ${cache_path}/${task}/${model_name}/${dataset}/${now:%Y-%m-%d}/${now:%H-%M-%S}

defaults:
  - estimators: default_estimators
  - stat_calculators: default_calculators
  - _self_

cache_path: ./workdir/output
save_path: '${hydra:run.dir}'
instruct: false
task: qa
# 注意：将 dataset 字段设置为 csv 以使用本地自定义 CSV 处理逻辑
dataset: csv

# 定义模型名称变量，用于路径插值
model_name: Llama-3.1-8B

# CSV 数据集相关参数（仅作为记录，实际加载时由 eval_dataset 指定）
text_column: statement
label_column: label
eval_split: test

batch_size: 8
load_from_disk: false
ignore_exceptions: false
seed:
  - 1

# ========== 模型配置 ==========
model:
  path: "/workspace/lm-polygraph_test/Llama-3.1-8B"
  load_model_args:
    device_map: "cuda:0"

# ========== CSV 数据集配置 ==========
eval_dataset:
  _target_: lm_polygraph.datasets.CSVDataset
  # 使用 data_files 显式指定 CSV 文件的绝对路径，
  # 这样 datasets.load_dataset 只会加载该文件而不会扫描目录下的其它 CSV 文件（如 polygraph_eval.log）。
  data_files: "/workspace/lm-polygraph_test/all_true_false_combined.csv"
  input_key: statement
  reference_key: label

# ========== 不确定性估计 ==========
uncertainty_estimators:
  - name: "mean_pointwise_mutual_information"
  - name: "perplexity"
  - name: "mean_token_entropy"
  - name: "max_token_entropy"

# ========== 生成相关配置 ==========
generation_params:
  generate_until:
    - "\n"

generation:
  do_sample: false
  num_beams: 1
  temperature: 1.0

max_new_tokens: 64

generation_metrics: null
